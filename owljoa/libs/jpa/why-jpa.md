# JPA 사용의 이유

&nbsp;&nbsp; 어떤 라이브러리를 도입하든 혹은 레거시에 이미 도입되어 있는 라이브러리든,, 잘 알고 사용하기 위해서는 공부를 해야하는데, 공부를 하기위해서는 단순히 "요즘 트렌드라서,,, 보통 이거 사용하길래,,, 그냥 레거시라서,, " 라는  이유보다는 좀 더 명확한 근거가 있어야 동기부여가 된다고 생각한다.

&nbsp;&nbsp; JPA도 요즘 트렌드라고 하고 나도 사용하고 있지만, 누군가 나에게 JPA를 사용하는 이유에 대해 물어보면 뭘 말해야할지 모르겠다..

&nbsp;&nbsp; 그래서 이 글의 목적은 JPA 사용 이유를 정리하는 것이고, 내용은 김영한님의 "자바 ORM 표준 JPA 프로그래밍" 책을 기반으로한다.

---

<br><br>

## 1. SQL을 직접 작성하기 때문에 발생하는 문제점
---
JPA 이전에는 JDBC API를 직접 사용하거나 MyBatis나 스프링 JdbcTemplate을 거쳐오면서 반복적인 코드를 많이 줄였지만, SQL을 직접 작성하는 방식은 변하지 않았다.

SQL을 직접 작성하기 때문에 발생하는 문제는 다음과 같다.

- 도메인이 추가될 때마다 CRUD 쿼리를 반복적으로 작성해야한다.
- 테이블에 컬럼이 하나 추가되면 해당 테이블에 대해 작성했던 쿼리를 대부분 수정해야한다.
    - 단순히 컬럼 하나를 추가하는 것이 아닌 연관관계의 추가나 기존에 연관관계가 있는 상태에서 컬럼의 추가 혹은 제거라면 작업량은 더 많이 늘어날 것이다.
- 작성한 SQL은 문자열이기 때문에 컴파일 시점에 검증할 수 없다.
    - 개발자의 실수는 늘 존재하기 때문에 컴파일 시점에 검증하지 못하는 것은 아쉬운 점으로 보인다.

<br><br>

## 2. JPA가 해결한 방법
---

JPA를 사용하면 CRUD와 같은 단순한 쿼리는 JPA에서 제공해주는 API를 사용하면 JPA가 쿼리를 대신 작성하고 실행해준다.

> JPA가 작성해주는 쿼리는 못믿겠다! 성능이 문제가 될 것이다! 복잡한 쿼리를 짜야하는데 JPA를 아직 잘 모른다!
는 분들을 위한 것인지는 잘 모르겠지만,, 네이티브 쿼리를 직접 작성해서 사용할 수 있는 기능도 제공한다.

스프링 data jpa를 사용하는 코드로 예를 들면 아래와 같이 작성해도 JPA가 해당 객체에 맞게 쿼리를 만들어 실행해주고, 단순히 쿼리를 대신 작성해주는 것 이상의 기능도 제공한다.

```java
// 저장
Member member = new Member("nameOfMember", "genderOfMember");
memberJpaRepository.save(member);

// 수정
Member member = memberJpaRepository.findById(memberId);
member.setName("changedName");


// Member의 연관 객체인 Team 조회
Team team = member.getTeam();
```

- 저장 메소드(save) 실행 시 적절한 JPA가 insert SQL 구문을 만들어 DB에 전달한다.
- 수정 메소드는 별도로 없고 객체 조회 후 필드값을 변경하먼, 트랜잭션 커밋 시점에 DB에 적절한 update SQL 구문을 전달한다.
- 연관 객체를 사용하는 시점에 적절한 select SQL 구문을 만들어 DB에 전달한다.



<br><br>


## 3. 정리
---

이 글에서는 이전의 SQL을 직접 사용하는 DB 접근방식의 생산성과 유지보수의 문제점을 JPA가 어떻게 해결했는지 정리했다.

이후에 누군가 JPA를 왜 사용하는지에 대해 이유를 궁금해한다면, 이 글을 참고하면 간단하게 설명하기에는 좋지 않을까 생각된다.

책에서는 RDB와 객체의 패러다임 불일치에 대한 내용과 그것을 JPA가 어떤 방식으로 해결했는지도 언급하지만, 그 내용은 이후에 추가로 정리해봐야겠다..